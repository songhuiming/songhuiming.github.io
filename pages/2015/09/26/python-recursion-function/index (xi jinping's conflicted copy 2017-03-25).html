<!DOCTYPE html>
<html lang="en">
<head>
          <title>pydata</title>
        <meta charset="utf-8" />
        <link href="/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="pydata Full Atom Feed" />
        <link href="/feeds/programming.atom.xml" type="application/atom+xml" rel="alternate" title="pydata Categories Atom Feed" />



    <meta name="tags" content="python" />

</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">pydata <strong>Keep Looking, Don't Settle</strong></a></h1>
        </header><!-- /#banner -->
        <nav id="menu"><ul>
            <li><a href="/functions/archives.html">Archives</a></li>
        </ul></nav><!-- /#menu -->
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="/pages/2015/09/26/python-recursion-function/" rel="bookmark"
         title="Permalink to python recursion function">python recursion function</a></h2>
 
  </header>
  <footer class="post-info">
    <abbr class="published" title="2015-09-26T00:00:00-05:00">
      Sat 26 September 2015
    </abbr>
    <address class="vcard author">
      By           <a class="url fn" href="/author/huiming-song.html">Huiming Song</a>
    </address>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <h4>好多地方都会用到recursion function，特别是在构造decision tree的时候</h4>
<h4>recursion function就是函数调用自身。recursion function通常需要下面两个过程：</h4>
<ol>
<li>
<p><strong>Base case</strong>: 就是不需要调用自身就能给出答案的部分，通常是递归初始的时候。比如求阶乘 $n=1$ 和 $n=0$ 的时候</p>
</li>
<li>
<p><strong>Recursive case</strong>: 函数调用自身进行计算的部分. 比如阶乘里面  $f(n) = f(n - 1) \times n = (n - 1)! \times n$ 部分</p>
</li>
</ol>
<h5>下面是几个例子，用来说明recursion怎么构造，怎么使用</h5>
<div class="highlight"><pre>    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    第一个问题是构造pascal 三角。下一行最两边是1， 生下来的元素是上一行两两元素的和。所以这么构造：</span>
<span class="sd">    1： 只有一行或者两行，那就是1</span>
<span class="sd">    2： 从第三行开始，两边是1，中间是上一行从第一个元素开始，第一个元素与第二个元素的和。</span>

<span class="sd">    Question 1. Pascal&#39;s Triangle:</span>

<span class="sd">                  1</span>
<span class="sd">               1     1</span>
<span class="sd">            1     2    1</span>
<span class="sd">          1    3     3    1</span>
<span class="sd">       1    4     6     4    1</span>
<span class="sd">    1    5    10     10    5    1</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">pascal_t</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="k">elif</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">po</span> <span class="o">=</span> <span class="n">pascal_t</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">po</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">po</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">po</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">print</span> <span class="n">pascal_t</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>

    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>


    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Fibonacci数：第n个数是前面两个数的和</span>

<span class="sd">    Question 2: Fibonacci numbers from Pascal Triangle</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">fib</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="n">memo</span> <span class="o">=</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
    <span class="k">def</span> <span class="nf">fibm</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">memo</span><span class="p">:</span>
            <span class="n">memo</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">fibm</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fibm</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">memo</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>

    <span class="n">fibm</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>    

    <span class="mi">8</span>


    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    列出小于等于n的质数：列出从2到n的所有数，然后对i=2，删去i的2倍，3倍，等等；对i=3，做同样的事情；</span>
<span class="sd">    最后生下来的数字既不是2的倍数，也不是3的倍数，也不是4的倍数，等等。它们就是质数</span>

<span class="sd">    Question 3. prime numbers. The sieve of Eratosthenes to find all prime numbers up to n.</span>
<span class="sd">    1. Create a list of integers from two to n: 2, 3, 4, ..., n</span>
<span class="sd">    2. Start with a counter i set to 2, i.e. the first prime number</span>
<span class="sd">    3. Starting from i+i, count up by i and remove those numbers from the list, i.e. 2*i, 3*i, 4*i ...</span>
<span class="sd">    4. Find the first number of the list following i. This is the next prime number.</span>
<span class="sd">    5. Set i to the number found in the previous step</span>
<span class="sd">    6. Repeat steps 3 and 4 until i is greater than n. (As an improvement: It&#39;s enough to go to the square root of n)</span>
<span class="sd">    7. All the numbers, which are still in the list, are prime numbers</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">sieve_prime_1</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lst</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>                                     <span class="c1"># step 1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>                                   <span class="c1"># step 2</span>
                <span class="n">no_p</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">)]</span>          <span class="c1"># step 3</span>
                <span class="n">rest</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">lst</span> <span class="k">if</span> <span class="n">j</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">no_p</span><span class="p">]</span>            <span class="c1"># step 3 to remove and step 4</span>
                <span class="n">lst</span> <span class="o">=</span> <span class="n">rest</span>                                          <span class="c1"># step 5, 6</span>
            <span class="k">return</span> <span class="n">rest</span>

    <span class="k">def</span> <span class="nf">sieve_prime_2</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">p</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>     <span class="c1"># step 1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span><span class="p">:</span>
                <span class="n">no_p</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">p</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">)]</span>        <span class="c1"># step 2, 3   2*i, 3*i, 4*i ...</span>
                <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="n">j</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">if</span> <span class="n">j</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">no_p</span><span class="p">]</span>            <span class="c1"># step 4, 5, 6</span>
            <span class="k">return</span> <span class="n">p</span>


    <span class="k">print</span> <span class="n">sieve_prime_1</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">sieve_prime_2</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>

    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">47</span><span class="p">]</span>
    <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">47</span><span class="p">]</span>


    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    爬n级台阶：每次可以爬一级或者两级。总共有多少爬法。</span>
<span class="sd">    从第n-1到第n：增加了一级台阶，把这一级台阶插到第n-1次的所有办法里面每个办法里每个位置。然后去除重复的办法。</span>
<span class="sd">    如果n是偶数，增加一个办法：每次都爬两级</span>

<span class="sd">    Question 4. I want to go up a flight of stairs that has n steps. I can either take 1 or 2 steps each time.</span>
<span class="sd">    How many different ways can I go up this flight of stairs?  </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># n=3,  s = [[1,1,1], [1,2], [2,1]]</span>

    <span class="kn">import</span> <span class="nn">itertools</span>

    <span class="c1"># de-dup the duplicated elements in the list while the elements are lists</span>
    <span class="k">def</span> <span class="nf">dedup_list</span><span class="p">(</span><span class="n">ls</span><span class="p">):</span>
        <span class="n">ls0</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">ls</span><span class="p">)</span>
        <span class="n">newls</span> <span class="o">=</span> <span class="p">[</span><span class="n">ls0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ls0</span><span class="p">))</span> <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="n">ls</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="n">ls</span><span class="p">[</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">newls</span>

    <span class="c1"># from n-1 to n, insert &#39;1&#39; to all the positions in the results of step n-1</span>
    <span class="c1"># s is the result in step n-1, it is a list of lists</span>
    <span class="c1"># n=3,  s = [[1,1,1], [1,2], [2,1]]</span>
    <span class="k">def</span> <span class="nf">inserts</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
        <span class="n">newls</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">ls0</span> <span class="ow">in</span> <span class="n">s</span><span class="p">:</span>          <span class="c1">#e.g. ls0 = [1,1,1]</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ls0</span><span class="p">))</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">ls0p</span> <span class="o">=</span> <span class="n">ls0</span><span class="p">[:</span><span class="n">p</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">ls0</span><span class="p">[</span><span class="n">p</span><span class="p">:]</span>
                <span class="n">newls</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ls0p</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dedup_list</span><span class="p">(</span><span class="n">newls</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">steps</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">n</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[[</span><span class="mi">1</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s0</span> <span class="o">=</span> <span class="n">steps</span><span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">inserts</span><span class="p">(</span><span class="n">s0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">inserts</span><span class="p">(</span><span class="n">s0</span><span class="p">)</span> <span class="o">+</span> <span class="p">[[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)]</span>

    <span class="n">steps</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

    <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>


    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    反序一个列表：把最后一个元素拿出来放最前面，然后反序拿出最后一个元素后剩下来的列表</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">reverse_iter</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">x</span>
        <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span> <span class="o">+</span> <span class="n">reverse_iter</span><span class="p">(</span><span class="n">x</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">reverse_iter</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

    <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>


<p>reference</p>
<p>1.: <a href="http://www.python-course.eu/python3_recursive_functions.php">Recursive Functions</a></p>
  </div><!-- /.entry-content -->
</section>
        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>